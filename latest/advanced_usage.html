<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · DSGE.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="../versions.js"></script></head><body><nav class="toc"><a href="index.html"><img class="logo" src="assets/logo.png" alt="DSGE.jl logo"/></a><h1>DSGE.jl</h1><form class="search" action="search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="model_design.html">Model Design</a></li><li><a class="toctext" href="running_existing_model.html">Running An Existing Model</a></li><li class="current"><a class="toctext" href="advanced_usage.html">Advanced Usage</a><ul class="internal"><li><a class="toctext" href="#Package-Directory-Structure-1">Package Directory Structure</a></li><li><a class="toctext" href="#Working-with-Settings-1">Working with Settings</a></li><li><a class="toctext" href="#editing-extending-model-1">Editing or Extending a Model</a></li></ul></li><li><a class="toctext" href="input_data.html">Input Data</a></li><li><a class="toctext" href="frbny_data.html">FRBNY Model Input Data</a></li><li><a class="toctext" href="implementation_details.html">Implementation Details</a></li><li><a class="toctext" href="solving.html">Solving the Model</a></li><li><a class="toctext" href="estimation.html">Estimating the Model</a></li><li><a class="toctext" href="algorithms.html">Algorithms</a></li><li><a class="toctext" href="contributing.html">Contributing to DSGE.jl</a></li><li><a class="toctext" href="MatlabToJuliaTransition.html">MATLAB to Julia Transition</a></li><li><a class="toctext" href="license.html">License</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="advanced_usage.html">Advanced Usage</a></li></ul><a class="edit-page" href="https://github.com/FRBNY-DSGE/DSGE.jl/tree/c5e9f60d119c08107c75718b1c3bddbfb9ab1e8e/docs/src/advanced_usage.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Advanced-Usage-1" href="#Advanced-Usage-1">Advanced Usage</a></h1><h2><a class="nav-anchor" id="Package-Directory-Structure-1" href="#Package-Directory-Structure-1">Package Directory Structure</a></h2><p>The package directory structure follows Julia module conventions. Directories in square brackets indicate future additions. <em>Note that this directory tree is not linked, although it appears to be.</em></p><ul><li><a href="pkg_structure.html#[DSGE.jl](https://github.com/FRBNY-DSGE/DSGE.jl)-1"><a href="https://github.com/FRBNY-DSGE/DSGE.jl"><code>DSGE.jl</code></a></a></li><ul><li><a href="pkg_structure.html#doc/:-Code-and-model-documentation.-1"><code>doc/</code>: Code and model documentation.</a></li><li><a href="pkg_structure.html#save/:-Sample-input-files;-default-input/output-directories.-1"><code>save/</code>: Sample input files; default input/output directories.</a></li><li><a href="pkg_structure.html#src/-1"><code>src/</code></a></li><ul><li><a href="pkg_structure.html#DSGE.jl:-The-main-module-file.-1"><code>DSGE.jl</code>: The main module file.</a></li><li><a href="pkg_structure.html#abstractdsgemodel.jl:-Defines-the-AbstractModel-type.-1"><code>abstractdsgemodel.jl</code>: Defines the <code>AbstractModel</code> type.</a></li><li><a href="pkg_structure.html#parameters.jl:-Implements-the-AbstractParameter-type-and-its-1"><code>parameters.jl</code>: Implements the <code>AbstractParameter</code> type and its</a></li><li><a href="pkg_structure.html#settings.jl:-Implements-the-Setting-type.-1"><code>settings.jl</code>: Implements the <code>Setting</code> type.</a></li><li><a href="pkg_structure.html#defaults.jl:-Specifies-default-Settings.-1"><code>defaults.jl</code>: Specifies default <code>Setting</code>s.</a></li><li><a href="pkg_structure.html#distributions_ext.jl:-DSGE-specific-extensions-of-Distributions-functionality.-1"><code>distributions_ext.jl</code>: DSGE-specific extensions of <code>Distributions</code> functionality.</a></li><li><a href="pkg_structure.html#data/:-Manipulating-and-updating-input-dataset.-1"><code>data/</code>: Manipulating and updating input dataset.</a></li><li><a href="pkg_structure.html#solve/:-Solving-the-model;-includes-gensys.jl-code.-1"><code>solve/</code>: Solving the model; includes <code>gensys.jl</code> code.</a></li><li><a href="pkg_structure.html#estimate/:-Optimization,-posterior-sampling,-and-other-functionality.-1"><code>estimate/</code>: Optimization, posterior sampling, and other functionality.</a></li><li><a href="pkg_structure.html#[xxx/]:-Other-model-functionality,-such-as-forecasts,-impulse-response-functions,-and-shock-decompositions.-1">[<code>xxx/</code>]: Other model functionality, such as forecasts, impulse response functions, and shock decompositions.</a></li><li><a href="pkg_structure.html#models/-1"><code>models/</code></a></li><ul><li><a href="pkg_structure.html#m990/:-Contains-code-to-define-and-initialize-version-990-of-the-FRBNY-DSGE-model.-1"><code>m990/</code>: Contains code to define and initialize version 990 of the FRBNY DSGE model.</a></li><ul><li><a href="pkg_structure.html#m990.jl:-Constructs-a-Model990-object.-1"><code>m990.jl</code>: Constructs a <code>Model990</code> object.</a></li><li><a href="pkg_structure.html#eqcond.jl:-Constructs-Model990-equilibrium-condition-matrices-1"><code>eqcond.jl</code>: Constructs <code>Model990</code> equilibrium condition matrices</a></li><li><a href="pkg_structure.html#measurement.jl:-Constructs-Model990-measurement-equation-matrices.-1"><code>measurement.jl</code>: Constructs <code>Model990</code> measurement equation matrices.</a></li><li><a href="pkg_structure.html#subspecs.jl:-Code-for-model-sub-specifications-is-defined-here.-See-[Editing-or-Extending-a-Model](@ref-editing-extending-model)-for-details-on-constructing-model-sub-specifications.-1"><code>subspecs.jl</code>: Code for model sub-specifications is defined here. See <a href="advanced_usage.html#editing-extending-model-1">Editing or Extending a Model</a> for details on constructing model sub-specifications.</a></li><li><a href="pkg_structure.html#augment_states.jl:-Code-for-augmenting-the-state-space-system-after-model-solution.-1"><code>augment_states.jl</code>: Code for augmenting the state space system after model solution.</a></li></ul><li><a href="pkg_structure.html#[[m991/]]:-Code-for-new-models-should-be-kept-in-directories-at-this-level-in-the-directory-tree-1">[<code>[m991/]</code>]: Code for new models should be kept in directories at this level in the directory tree</a></li></ul></ul><li><a href="pkg_structure.html#test/:-Module-test-suite.-1"><code>test/</code>: Module test suite.</a></li></ul></ul><h2><a class="nav-anchor" id="Working-with-Settings-1" href="#Working-with-Settings-1">Working with Settings</a></h2><p>There are many computational settings that affect how the code runs without affecting the mathematical definition of the model. </p><p>Below, we describe several important settings for package usage.</p><p>For more details on implementation and usage of settings, see <a href="implementation_details.html#Model-Settings-1">Model Settings</a>.</p><p>See <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/defaults.jl">defaults.jl</a> for the complete description of default settings.</p><h4><a class="nav-anchor" id="General-1" href="#General-1">General</a></h4><ul><li><code>dataroot</code>: The root directory for   model input data.</li><li><code>saveroot</code>: The root directory for model output.</li><li><code>use_parallel_workers</code>: Use available parallel workers in computaitons.</li><li><code>data_vintage</code>: Data vintage identifier, formatted   <code>yymmdd</code>. By default, <code>data_vintage</code> is set to today&#39;s date. It is (currently) the only   setting printed to output filenames by default.</li></ul><h4><a class="nav-anchor" id="Dates-1" href="#Dates-1">Dates</a></h4><ul><li><code>date_presample_start</code>: Start date of pre-sample.</li><li><code>date_mainsample_start</code>: Start date of main sample.</li><li><code>date_zlbregime_start</code>: Start date of zero lower bound regime.</li><li><code>date_mainsample_end</code>: End date of main sample.</li><li><code>date_forecast_start</code>: Start date of forecast period.</li><li><code>date_forecast_end</code>: End date of forecast period.</li></ul><h4><a class="nav-anchor" id="Anticipated-Shocks-1" href="#Anticipated-Shocks-1">Anticipated Shocks</a></h4><ul><li><code>n_anticipated_shocks</code>: Number of anticipated policy shocks.</li><li><code>n_anticipated_shocks_padding</code>: Padding for anticipated shocks.</li></ul><h4><a class="nav-anchor" id="Estimation-1" href="#Estimation-1">Estimation</a></h4><ul><li><code>reoptimize</code>: Whether to reoptimize the posterior mode. If <code>true</code>     (the default), <code>estimate()</code> begins reoptimizing from the model     object&#39;s parameter vector. See <a href="@ref     estimation-reoptimizing">Optimizing or Reoptimizing</a> for more details.</li><li><code>calculate_hessian</code>: Whether to compute the Hessian. If <code>true</code> (the     default), <code>estimate()</code> calculates the Hessian at the posterior mode.</li></ul><h4><a class="nav-anchor" id="Metropolis-Hastings-1" href="#Metropolis-Hastings-1">Metropolis-Hastings</a></h4><ul><li><code>n_mh_simulations</code>: Number of draws from the posterior distribution per block.</li><li><code>n_mh_blocks</code>: Number of blocks to run Metropolis-Hastings.</li><li><code>n_mh_burn</code>: Number of blocks to discard as burn-in for Metropolis-Hastings.</li><li><code>mh_thin</code>: Metropolis-Hastings thinning step.</li></ul><h3><a class="nav-anchor" id="Accessing-Settings-1" href="#Accessing-Settings-1">Accessing Settings</a></h3><p>The function <code>get_setting(m::AbstractModel, s::Symbol)</code> returns the value of the setting <code>s</code> in <code>m.settings</code>. Some settings also have explicit getter methods that take only the model object <code>m</code> as an argument. Note that not all are exported.</p><p><em>I/O</em>:</p><ul><li><code>saveroot(m)</code>,</li><li><code>dataroot(m)</code>,</li><li><code>data_vintage(m)</code>,</li></ul><p><em>Parallelization</em>:</p><ul><li><code>use_parallel_workers(m)</code></li></ul><p><em>Estimation</em>:</p><ul><li><code>reoptimize(m)</code>,</li><li><code>calculate_hessian(m)</code>,</li></ul><p><em>Metropolis-Hastings</em>:</p><ul><li><code>n_mh_blocks(m)</code>,</li><li><code>n_mh_simulations(m)</code>,</li><li><code>n_mh_burn(m)</code>,</li><li><code>mh_thin(m)</code></li></ul><h3><a class="nav-anchor" id="Overwriting-Default-Settings-1" href="#Overwriting-Default-Settings-1">Overwriting Default Settings</a></h3><p>To overwrite default settings added during model construction, a user must define a new <code>Setting</code> object and update the corresponding entry in the model&#39;s <code>settings</code> dictionary using the <code>&lt;=</code> syntax. If the <code>print</code>, <code>code</code>, and <code>description</code> fields of the new <code>Setting</code> object are not provided, the fields of the existing setting will be maintained. If new values for <code>print</code>, <code>code</code>, and <code>description</code> are specified, and if these new values are distinct from the defaults for those fields, the fields of the existing setting will be updated.</p><p>For example, overwriting <code>use_parallel_workers</code> should look like this:</p><pre><code class="language-julia">m = Model990()
m &lt;= Setting(:use_parallel_workers, true)</code></pre><h2><a class="nav-anchor" id="editing-extending-model-1" href="#editing-extending-model-1">Editing or Extending a Model</a></h2><p>Users may want to extend or edit <code>Model990</code> in a number of different ways.  The most common changes are listed below, in decreasing order of complexity:</p><ol><li>Add new parameters</li><li>Modify equilibrium conditions or measurement equations</li><li>Change the values of various parameter fields (i.e. initial <code>value</code>, <code>prior</code>,    <code>transform</code>, etc.)</li><li>Change the values of various computational settings (i.e. <code>reoptimize</code>,    <code>n_mh_blocks</code>)</li></ol><p>Points 1 and 2 often go together (adding a new parameter guarantees a change in equilibrium conditions), and are such fundamental changes that they increment the model specification number and require the definition of a new subtype of <code>AbstractModel</code> (for instance, <code>Model991</code>).  See <a href="advanced_usage.html#model-specification-mspec-1">Model specification</a> for more details.</p><p>Any changes to the initialization of preexisting parameters are defined as a new model <em>sub-specification</em>, or <em>subspec</em>. While less significant than a change to the model&#39;s equilibrium conditions, changing the values of some parameter fields (especially priors) can have economic significance over and above settings we use for computational purposes. <strong>Parameter definitions should not be modified in the model object&#39;s constructor.</strong> First, incrementing the model&#39;s sub-specification number when parameters are changed improves model-level (as opposed to code-level) version control. Second, it avoids potential output filename collisions, preventing the user from overwriting output from previous estimations with the original parameters. The protocol for defining new sub-specifications is described in <a href="advanced_usage.html#model-sub-specifications-msubspec-1">Model sub-specifications</a>.</p><p>Overriding default settings is described in the <a href="implementation_details.html#Model-Settings-1">Model Settings</a> section.</p><h3><a class="nav-anchor" id="model-specification-mspec-1" href="#model-specification-mspec-1">Model specification (<code>m.spec</code>)</a></h3><p>A particular model, which corresponds to a subtype of <code>AbstractModel</code>, is defined as a set of parameters, equilibrium conditions (defined by the <code>eqcond</code> function) and measurement equations (defined by the <code>measurement</code> function).  Therefore, the addition of new parameters, states, or observables, or any changes to the equilibrium conditions or measurement equations necessitate the creation of a new subtype of <code>AbstractModel.</code></p><p>To create a new model object, we recommend doing the following:</p><ol><li>Duplicate the <code>m990</code> directory within the <a href="https://github.com/FRBNY-DSGE/DSGE.jl/tree/master/src/models">models</a> directory. Name the new    directory <code>mXXX.jl</code>, where <code>XXX</code> is your chosen model specification number or string.    Rename <code>m990.jl</code> in this directory to <code>mXXX.jl</code>.</li><li>In the <code>mXXX/</code> directory, change all references to <code>Model990</code> to <code>ModelXXX</code>.</li><li>Edit the <code>m990.jl</code>, <code>eqcond.jl</code>, and <code>measurement.jl</code> files as you see fit.  If adding    new states, equilibrium conditions, shocks, or observables, be sure to add them to the    appropriate list in <code>init_model_indices</code>.</li><li>Open the module file, <code>src/DSGE.jl</code>. Add <code>ModelXXX</code> to the list of functions to export,    and include each of the files in <code>src/model/mXXX</code>.</li></ol><h3><a class="nav-anchor" id="model-sub-specifications-msubspec-1" href="#model-sub-specifications-msubspec-1">Model sub-specifications (<code>m.subspec</code>)</a></h3><p><code>Model990</code> sub-specifications are initialized by overwriting initial parameter definitions before the model object is fully constructed. This happens via a call to <code>init_subspec</code> in the <code>Model990</code> constructor. (Clearly, an identical protocol should be followed for new model types as well.)</p><p>To create a new sub-specification (e.g., subspec 1) of <code>Model990</code>, edit the file <code>src/models/subspecs.jl</code> as follows (note that this example is not actually sub-specification <code>1</code> of <code>Model990</code>. In the source code, our sub-specification <code>5</code> is provided as additional example.):</p><p><strong>Step 1.</strong> Define a new function, <code>ss1</code>, that takes an object of type <code>Model990</code> (not    <code>AbstractModel</code>!) as an argument. In this function, construct new parameter objects and    overwrite existing model parameters using the <code>&lt;=</code> syntax. For example,</p><pre><code class="language-julia">function ss1(m::Model990)
    m &lt;= parameter(:ι_w, 0.000, (0.0, .9999), (0.0,0.9999), DSGE.Untransformed(), Normal(0.0,1.0), fixed=false,
                   description=&quot;ι_w: Some description.&quot;,
                   tex_label=&quot;\\iota_w&quot;)
    m &lt;= parameter(:ι_p, 0.0, fixed=true,
                   description= &quot;ι_p: Some description&quot;
                   tex_label=&quot;\\iota_p&quot;)
end</code></pre><p><strong>Step 2.</strong> Add an <code>elseif</code> condition to <code>init_subspec</code>:</p><pre><code class="language-julia">    ...
    elseif subspec(m) == &quot;ss1&quot;
        return ss1(m)
    ...</code></pre><p>To construct an instance of <code>Model990</code>, <code>ss1</code>, call the constructor for <code>Model990</code> with <code>ss1</code> as an argument. For example,</p><pre><code class="language-julia">m = Model990(&quot;ss1&quot;)</code></pre><footer><hr/><a class="previous" href="running_existing_model.html"><span class="direction">Previous</span><span class="title">Running An Existing Model</span></a><a class="next" href="input_data.html"><span class="direction">Next</span><span class="title">Input Data</span></a></footer></article></body></html>
